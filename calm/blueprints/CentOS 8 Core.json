{"status":{},"contains_secrets":false,"product_version":"3.0.0.1","spec":{"description":"Deploy CentOS 8 Core\n@@{address}@@\n","resources":{"client_attrs":{},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"85a1fb84_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d3662af6_runbook","main_task_local_reference":{"kind":"app_task","name":"85a1fb84_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b6ee4fcb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f70eb831_runbook","main_task_local_reference":{"kind":"app_task","name":"b6ee4fcb_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c7aa5bbc_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"686b11e2_runbook","main_task_local_reference":{"kind":"app_task","name":"c7aa5bbc_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7af4ebf9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"07ee3866_runbook","main_task_local_reference":{"kind":"app_task","name":"7af4ebf9_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b228380f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"94c569bc_runbook","main_task_local_reference":{"kind":"app_task","name":"b228380f_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"Service","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"CentOS 8 Core","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{calm_application_name}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"9307a1d2-4a14-4011-8de3-f122a9f21983"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\ntimezone: America\/Montreal\nhostname: @@{calm_application_name}@@.@@{domain_name}@@\nssh_pwauth: True ## This line enables ssh password authentication\nchpasswd:\n  list: |\n    root:$1$yoursalt$pLtHd23MuLzrCHUjhehF5.\n  expire: False\npackage_upgrade: true"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"0b69b6d7-9356-4275-8ce1-0f17ce91539d","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS 8.1 Generic Cloud 1811","uuid":"7b5b9190-55d6-46a0-b263-fea319e1b326"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":{"OSType":"Linux","Environment":"Testing"}},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CENTOS"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"pc"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Service"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CentOS Core Preparation"},{"kind":"app_task","name":"chronyc Installation"},{"kind":"app_task","name":"stress installation"},{"kind":"app_task","name":"CleanUp"}],"name":"c9a22c58_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"CentOS Core Preparation"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"chronyc Installation"}},{"from_task_reference":{"kind":"app_task","name":"chronyc Installation"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"stress installation"}},{"from_task_reference":{"kind":"app_task","name":"stress installation"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CleanUp"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CentOS Core Preparation","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Clean Yum\nsudo yum clean all\nsudo rm -rf \/var\/cache\/yum\nsudo rm -rf \/var\/tmp\/yum-*\nsudo package-cleanup --leaves | xargs yum remove -y\n\n# -*- update packages\nsudo yum update -y\nsudo yum install vim bash-completion cloud-utils-growpart python3 lvm2 tar firewalld -y\n\n# Disable SELINUX\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/sysconfig\/selinux\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/selinux\/config\nsudo setenforce 0\n\necho \"System packages are installed\"","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"chronyc Installation","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install ntp client\nsudo dnf install chrony -y\nsudo systemctl enable chronyd\n\nsudo systemctl restart chronyd\n\nsudo chronyc clients","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"stress installation","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Enable snapd\nsudo yum install epel-release -y\nsudo yum install snapd -y\n\n#Once installed, the systemd unit that manages the main snap communication socket needs to be enabled\nsudo systemctl enable --now snapd.socket\nsudo ln -s \/var\/lib\/snapd\/snap \/snap\n\nsudo systemctl restart snapd.seeded.service\n\n#Install stress-ng\nsudo snap install stress-ng","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CleanUp","attrs":{"script":"# this script clear logs in Linux (made in CentOS)\ncd \/var\/log\nsudo truncate -s 0 \/var\/log\/*log\nsudo find . -name \"*.gz\" -type f -delete\nsudo find . -name \"*.0\" -type f -delete\nsudo find . -name \"*.1\" -type f -delete\nsudo find . -name \"*.log.*\" -type f -delete\nhistory -c","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fcf31d0a_runbook","main_task_local_reference":{"kind":"app_task","name":"c9a22c58_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c9bfdb2c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"fb1fd9e5_runbook","main_task_local_reference":{"kind":"app_task","name":"c9bfdb2c_dag"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"b6d1801b_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"CentOS 8 Core"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Start Memory Stress"}],"name":"f4e4e8a6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start Memory Stress","attrs":{"exit_status":[],"script":"stress-ng --vm 2 --vm-bytes 95% --vm-method all --verify --timeout 15m","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"5c695d52_runbook","main_task_local_reference":{"kind":"app_task","name":"f4e4e8a6_dag"},"variable_list":[]},"name":"Memory Stress"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Start CPU Stress"}],"name":"1bbcbf39_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start CPU Stress","attrs":{"exit_status":[],"script":"stress-ng --cpu 4 --timeout 15m --metrics-brief","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"783e772c_runbook","main_task_local_reference":{"kind":"app_task","name":"1bbcbf39_dag"},"variable_list":[]},"name":"CPU Stress"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Start Disk Stress"}],"name":"d753c0e8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Start Disk Stress","attrs":{"exit_status":[],"script":"stress-ng --disk 2 --io 2 --timeout 15m --metrics-brief","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"6e25b2d6_runbook","main_task_local_reference":{"kind":"app_task","name":"d753c0e8_dag"},"variable_list":[]},"name":"Disk Stress"}],"name":"Default","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"pc_ip","value":"172.16.32.10","label":"","attrs":{"type":"LOCAL"},"editables":{"value":false},"is_hidden":true,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^.*$"},"val_type":"STRING","is_mandatory":true,"description":"Please enter the domain name for this machine host name configuration","data_type":"BASE","type":"LOCAL","name":"domain_name","value":"chambly.grothe.local","label":"Domain Name","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":["chambly.grothe.local","grothe.local"]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"CENTOS"},"type":"USER"},"name":"CentOS 8 Core"},"api_version":"3.0","metadata":{"last_update_time":"1591649514259800","kind":"blueprint","spec_version":46,"creation_time":"1588026383204076","categories":{"TemplateType":"Vm"},"name":"CentOS 8 Core"}}